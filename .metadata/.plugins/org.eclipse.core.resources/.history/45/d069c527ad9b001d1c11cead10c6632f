package com.inetBanking.testCases;

import java.io.IOException;
import java.util.NoSuchElementException;

import org.junit.Assert;
import org.openqa.selenium.By;
import org.openqa.selenium.NoAlertPresentException;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import com.inetBanking.pageObjects.LoginPage;

public class TC_LoginDDT_002 extends BaseClass{

	@Test(dataProvider="LoginData")
	public void LoginDDT(String user, String pass) throws Exception {
		LoginPage lp= new LoginPage(driver);	
		lp.setusername(user);
		logger.info("enter username");
		lp.setpassword(pass);
		logger.info("enter password");
		lp.clickLoginbtn();
		logger.info("login button clicked");
		
		if(isAlertPresent()==true) {
		
			driver.switchTo().alert().accept();
			driver.switchTo().defaultContent();
			Assert.assertTrue(false);
			logger.info("test failed");
		}
		else {
			Assert.assertTrue(true);
			logger.info("test is passed");
		}
		
	}
		
	public boolean isAlertPresent() {
		try {
			driver.switchTo().alert();
			return true;
		} catch (NoAlertPresentException e) {
			return false;
		}
	
	
	@DataProvider(name="LoginData")
	public Object[][] getdata() {
	
String sheetName="logindata";
		
int rows =excel.getRowCount(sheetName);
int cols =excel.getColumnCount(sheetName);
Object[][] data =new Object[rows-1][cols];


for(int rowNum=2;rowNum<=rows;rowNum++) {   //2
	for(int colNum=0;colNum<cols;colNum++)	{
		
	//data[0][0]	
	data[rowNum-2][colNum]=excel.getCellData(sheetName,colNum, rowNum);
}


}
return data;

}
}